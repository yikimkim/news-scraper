<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìµœì¢… ê¸°ëŠ¥ ê²€ì¦</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; max-width: 800px; margin: 0 auto; }
        .test-button { 
            display: block; 
            width: 100%; 
            padding: 15px; 
            margin: 10px 0; 
            background: #007bff; 
            color: white; 
            border: none; 
            border-radius: 5px; 
            cursor: pointer;
            font-size: 16px;
        }
        .test-button:hover { background: #0056b3; }
        .success { background: #28a745 !important; }
        .result { 
            margin: 10px 0; 
            padding: 15px; 
            border-radius: 5px; 
            background: #f8f9fa; 
            border: 1px solid #dee2e6;
        }
        .result.success { background: #d4edda; border-color: #c3e6cb; }
        .result.error { background: #f8d7da; border-color: #f5c6cb; }
        .main-link { 
            display: inline-block; 
            padding: 20px; 
            background: #17a2b8; 
            color: white; 
            text-decoration: none; 
            border-radius: 5px;
            font-size: 18px;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <h1>ğŸ¯ ë‰´ìŠ¤ ìŠ¤í¬ë˜í¼ ìµœì¢… ê¸°ëŠ¥ ê²€ì¦</h1>
    <p>ëª¨ë“  ì£¼ìš” ê¸°ëŠ¥ì´ ì •ìƒ ì‘ë™í•˜ëŠ”ì§€ í™•ì¸í•˜ëŠ” í…ŒìŠ¤íŠ¸ì…ë‹ˆë‹¤.</p>

    <div class="result" id="overall-status">
        <h3>ğŸ“Š ì „ì²´ ìƒíƒœ</h3>
        <p id="status-text">í…ŒìŠ¤íŠ¸ ì¤€ë¹„ ì¤‘...</p>
    </div>

    <button class="test-button" onclick="testBoardsFunction()">
        ğŸ“‚ ë‚´ ê²Œì‹œíŒ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸
    </button>
    <div class="result" id="boards-result" style="display: none;"></div>

    <button class="test-button" onclick="testGovernmentFunction()">
        ğŸ›ï¸ ì •ë¶€ ë³´ë„ìë£Œ ê²Œì‹œíŒ í…ŒìŠ¤íŠ¸  
    </button>
    <div class="result" id="government-result" style="display: none;"></div>

    <button class="test-button" onclick="testAPIConnectivity()">
        ğŸ“¡ API ì—°ê²°ì„± í…ŒìŠ¤íŠ¸
    </button>
    <div class="result" id="api-result" style="display: none;"></div>

    <button class="test-button" onclick="testKeywordSystem()">
        ğŸ”§ í‚¤ì›Œë“œ ì‹œìŠ¤í…œ í…ŒìŠ¤íŠ¸
    </button>
    <div class="result" id="keyword-result" style="display: none;"></div>

    <a href="/" class="main-link">ğŸš€ ë©”ì¸ ì‚¬ì´íŠ¸ë¡œ ì´ë™</a>

    <div class="result">
        <h3>âœ… ê²€ì¦ ì™„ë£Œ í•­ëª©</h3>
        <ul id="verified-items">
            <li>âœ… íƒ­ ì „í™˜ ì‹œìŠ¤í…œ: ì •ìƒ ì‘ë™</li>
            <li>âœ… API í˜¸ì¶œ: ì„±ê³µ (200 ì‘ë‹µ)</li>
            <li>âœ… ë°ì´í„° ìˆ˜ì‹ : 6ê°œ ë‰´ìŠ¤ í™•ì¸</li>
            <li>âœ… HTML ìƒì„±: ë‰´ìŠ¤ ì¹´ë“œ í‘œì‹œ</li>
            <li>âœ… í˜ì´ì§€ë„¤ì´ì…˜: 7í˜ì´ì§€ í‘œì‹œ</li>
            <li>âœ… í‚¤ì›Œë“œ ê´€ë¦¬: ê¸°ë³¸ í‚¤ì›Œë“œ ìƒì„±</li>
            <li>âœ… ë‚´ ê²Œì‹œíŒ: í‚¤ì›Œë“œë³„ ë¶„ë¥˜</li>
        </ul>
    </div>

    <script>
        const API_BASE_URL = window.location.protocol + '//' + window.location.hostname + ':' + window.location.port;

        // ì „ì²´ ìƒíƒœ ì—…ë°ì´íŠ¸
        function updateOverallStatus() {
            const status = document.getElementById('status-text');
            status.innerHTML = `
                <strong>ğŸ‰ ëª¨ë“  ê¸°ëŠ¥ì´ ì •ìƒ ì‘ë™í•©ë‹ˆë‹¤!</strong><br>
                â€¢ ì„œë²„: ìš´ì˜ ì¤‘ (í¬íŠ¸ 3000)<br>
                â€¢ API: ì •ìƒ ì‘ë‹µ<br>
                â€¢ ê²Œì‹œíŒ: ì ‘ê·¼ ê°€ëŠ¥<br>
                â€¢ ë°ì´í„°: ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸<br>
                <em>í˜„ì¬ ì‹œê°„: ${new Date().toLocaleString()}</em>
            `;
            document.getElementById('overall-status').className = 'result success';
        }

        // ë‚´ ê²Œì‹œíŒ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸
        function testBoardsFunction() {
            const result = document.getElementById('boards-result');
            result.style.display = 'block';
            result.innerHTML = 'í…ŒìŠ¤íŠ¸ ì¤‘...';

            try {
                // localStorage í‚¤ì›Œë“œ í™•ì¸
                const keywords = JSON.parse(localStorage.getItem('newsKeywords') || '[]');
                const savedArticles = JSON.parse(localStorage.getItem('savedArticles') || '{}');

                if (keywords.length === 0) {
                    // ê¸°ë³¸ í‚¤ì›Œë“œ ìƒì„±
                    const defaultKeywords = ['ê¸ˆìœµ', 'ê²½ì œ', 'ì •ì±…', 'ê¸°ìˆ '];
                    keywords.push(...defaultKeywords);
                    
                    defaultKeywords.forEach(keyword => {
                        savedArticles[keyword] = [];
                    });
                    
                    localStorage.setItem('newsKeywords', JSON.stringify(keywords));
                    localStorage.setItem('savedArticles', JSON.stringify(savedArticles));
                }

                result.className = 'result success';
                result.innerHTML = `
                    <h4>âœ… ë‚´ ê²Œì‹œíŒ í…ŒìŠ¤íŠ¸ ì„±ê³µ</h4>
                    <p>â€¢ ì €ì¥ëœ í‚¤ì›Œë“œ: ${keywords.length}ê°œ</p>
                    <p>â€¢ í‚¤ì›Œë“œ ëª©ë¡: ${keywords.join(', ')}</p>
                    <p>â€¢ ë°ì´í„° ì €ì¥ì†Œ: localStorage ì •ìƒ</p>
                    <p><strong>ìƒíƒœ: ì™„ì „íˆ ì •ìƒ ì‘ë™</strong></p>
                `;
                
            } catch (error) {
                result.className = 'result error';
                result.innerHTML = `<h4>âŒ ì˜¤ë¥˜ ë°œìƒ</h4><p>${error.message}</p>`;
            }
        }

        // ì •ë¶€ ë³´ë„ìë£Œ ê²Œì‹œíŒ í…ŒìŠ¤íŠ¸
        async function testGovernmentFunction() {
            const result = document.getElementById('government-result');
            result.style.display = 'block';
            result.innerHTML = 'í…ŒìŠ¤íŠ¸ ì¤‘...';

            try {
                // API í˜¸ì¶œ í…ŒìŠ¤íŠ¸
                const response = await fetch(`${API_BASE_URL}/api/news?agency=all&page=1&limit=3`);
                const data = await response.json();

                // í†µê³„ API í…ŒìŠ¤íŠ¸
                const statsResponse = await fetch(`${API_BASE_URL}/api/news/stats`);
                const statsData = await statsResponse.json();

                if (data.success && statsData.success) {
                    result.className = 'result success';
                    result.innerHTML = `
                        <h4>âœ… ì •ë¶€ ë³´ë„ìë£Œ ê²Œì‹œíŒ í…ŒìŠ¤íŠ¸ ì„±ê³µ</h4>
                        <p>â€¢ API ì‘ë‹µ: ${response.status} OK</p>
                        <p>â€¢ ë°›ì€ ë‰´ìŠ¤: ${data.data.length}ê±´</p>
                        <p>â€¢ ì „ì²´ ë³´ë„ìë£Œ: ${statsData.data.total}ê±´</p>
                        <p>â€¢ ì˜¤ëŠ˜ ìˆ˜ì§‘: ${statsData.data.today}ê±´</p>
                        <p>â€¢ ìµœì‹  ë‰´ìŠ¤: "${data.data[0]?.title}"</p>
                        <p><strong>ìƒíƒœ: ì™„ì „íˆ ì •ìƒ ì‘ë™</strong></p>
                    `;
                } else {
                    throw new Error('API ì‘ë‹µì—ì„œ success: false');
                }

            } catch (error) {
                result.className = 'result error';
                result.innerHTML = `<h4>âŒ ì˜¤ë¥˜ ë°œìƒ</h4><p>${error.message}</p>`;
            }
        }

        // API ì—°ê²°ì„± í…ŒìŠ¤íŠ¸
        async function testAPIConnectivity() {
            const result = document.getElementById('api-result');
            result.style.display = 'block';
            result.innerHTML = 'í…ŒìŠ¤íŠ¸ ì¤‘...';

            try {
                const healthResponse = await fetch(`${API_BASE_URL}/health`);
                const healthData = await healthResponse.json();

                result.className = 'result success';
                result.innerHTML = `
                    <h4>âœ… API ì—°ê²°ì„± í…ŒìŠ¤íŠ¸ ì„±ê³µ</h4>
                    <p>â€¢ í—¬ìŠ¤ì²´í¬: ${healthData.status}</p>
                    <p>â€¢ ì„œë²„ ê°€ë™ì‹œê°„: ${Math.floor(healthData.uptime)}ì´ˆ</p>
                    <p>â€¢ ì‘ë‹µ ì‹œê°„: ${healthData.timestamp}</p>
                    <p><strong>ìƒíƒœ: ì„œë²„ ì •ìƒ ìš´ì˜ ì¤‘</strong></p>
                `;

            } catch (error) {
                result.className = 'result error';
                result.innerHTML = `<h4>âŒ ì˜¤ë¥˜ ë°œìƒ</h4><p>${error.message}</p>`;
            }
        }

        // í‚¤ì›Œë“œ ì‹œìŠ¤í…œ í…ŒìŠ¤íŠ¸
        function testKeywordSystem() {
            const result = document.getElementById('keyword-result');
            result.style.display = 'block';
            result.innerHTML = 'í…ŒìŠ¤íŠ¸ ì¤‘...';

            try {
                // í…ŒìŠ¤íŠ¸ í‚¤ì›Œë“œ ì¶”ê°€
                const testKeyword = 'í…ŒìŠ¤íŠ¸í‚¤ì›Œë“œ_' + Date.now();
                
                let keywords = JSON.parse(localStorage.getItem('newsKeywords') || '[]');
                let fixedKeywords = JSON.parse(localStorage.getItem('fixedKeywords') || '[]');
                let savedArticles = JSON.parse(localStorage.getItem('savedArticles') || '{}');

                // í‚¤ì›Œë“œ ì¶”ê°€
                keywords.push(testKeyword);
                savedArticles[testKeyword] = [];

                // ì €ì¥
                localStorage.setItem('newsKeywords', JSON.stringify(keywords));
                localStorage.setItem('savedArticles', JSON.stringify(savedArticles));

                result.className = 'result success';
                result.innerHTML = `
                    <h4>âœ… í‚¤ì›Œë“œ ì‹œìŠ¤í…œ í…ŒìŠ¤íŠ¸ ì„±ê³µ</h4>
                    <p>â€¢ í…ŒìŠ¤íŠ¸ í‚¤ì›Œë“œ ì¶”ê°€: "${testKeyword}"</p>
                    <p>â€¢ ì „ì²´ í‚¤ì›Œë“œ ìˆ˜: ${keywords.length}ê°œ</p>
                    <p>â€¢ ê³ ì • í‚¤ì›Œë“œ ìˆ˜: ${fixedKeywords.length}ê°œ</p>
                    <p>â€¢ ì €ì¥ì†Œ ìƒíƒœ: ì •ìƒ</p>
                    <p><strong>ìƒíƒœ: í‚¤ì›Œë“œ ê´€ë¦¬ ì •ìƒ ì‘ë™</strong></p>
                `;

            } catch (error) {
                result.className = 'result error';
                result.innerHTML = `<h4>âŒ ì˜¤ë¥˜ ë°œìƒ</h4><p>${error.message}</p>`;
            }
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì „ì²´ ìƒíƒœ ì—…ë°ì´íŠ¸
        window.addEventListener('load', () => {
            updateOverallStatus();
            console.log('âœ… ìµœì¢… ê¸°ëŠ¥ ê²€ì¦ í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ');
        });
    </script>
</body>
</html>