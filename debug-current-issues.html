<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í˜„ì¬ ì´ìŠˆ ë””ë²„ê·¸ í…ŒìŠ¤íŠ¸</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
        }
        .test-section {
            border: 1px solid #ddd;
            margin: 20px 0;
            padding: 20px;
            border-radius: 8px;
        }
        .test-section h3 {
            margin-top: 0;
            color: #333;
        }
        .status {
            padding: 5px 10px;
            border-radius: 4px;
            font-weight: bold;
        }
        .status.working { background: #d4edda; color: #155724; }
        .status.broken { background: #f8d7da; color: #721c24; }
        .status.unknown { background: #fff3cd; color: #856404; }
        
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #0056b3;
        }
        
        .console-output {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
            font-family: monospace;
            white-space: pre-wrap;
            max-height: 200px;
            overflow-y: auto;
        }
        
        .api-test {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 4px;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <h1>ğŸ” í•œêµ­ ì •ë¶€ ë‰´ìŠ¤ ìŠ¤í¬ë˜í¼ - í˜„ì¬ ì´ìŠˆ ì§„ë‹¨</h1>
    
    <div class="test-section">
        <h3>1. ğŸ›ï¸ ì •ë¶€ ë³´ë„ìë£Œ íƒ­ ì „í™˜ í…ŒìŠ¤íŠ¸</h3>
        <p>ì •ë¶€ ë³´ë„ìë£Œ íƒ­ìœ¼ë¡œ ì „í™˜í–ˆì„ ë•Œ ë°ì´í„°ê°€ ì œëŒ€ë¡œ ë¡œë“œë˜ëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.</p>
        <button onclick="testGovernmentTab()">ì •ë¶€ ë³´ë„ìë£Œ íƒ­ í…ŒìŠ¤íŠ¸</button>
        <div id="tab-test-result" class="console-output"></div>
    </div>

    <div class="test-section">
        <h3>2. ğŸ”˜ ê¸°ê´€ í•„í„° ë²„íŠ¼ í…ŒìŠ¤íŠ¸</h3>
        <p>ê¸ˆìœµìœ„ì›íšŒ, ê¸ˆìœµê°ë…ì›, ê³µì •ê±°ë˜ìœ„ì›íšŒ ë²„íŠ¼ì´ í´ë¦­ë˜ëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.</p>
        <button onclick="testAgencyButtons()">ê¸°ê´€ ë²„íŠ¼ í…ŒìŠ¤íŠ¸</button>
        <div id="agency-test-result" class="console-output"></div>
    </div>

    <div class="test-section">
        <h3>3. ğŸ”„ ìƒˆë¡œê³ ì¹¨ ë²„íŠ¼ API í…ŒìŠ¤íŠ¸</h3>
        <p>ìƒˆë¡œê³ ì¹¨ ë²„íŠ¼ì´ ì„œë²„ APIì™€ ì •ìƒì ìœ¼ë¡œ í†µì‹ í•˜ëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.</p>
        <button onclick="testRefreshAPI()">ìƒˆë¡œê³ ì¹¨ API í…ŒìŠ¤íŠ¸</button>
        <div id="refresh-test-result" class="console-output"></div>
    </div>

    <div class="test-section">
        <h3>4. âš¡ ë¹ ë¥¸ ê²€ìƒ‰ ê¸°ì‚¬ í´ë¦­ í…ŒìŠ¤íŠ¸</h3>
        <p>ë¹ ë¥¸ ê²€ìƒ‰ì—ì„œ ê¸°ì‚¬ ì¹´ë“œë¥¼ í´ë¦­í–ˆì„ ë•Œ ìƒˆ ì°½ìœ¼ë¡œ ì—´ë¦¬ëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.</p>
        <button onclick="testQuickSearch()">ë¹ ë¥¸ ê²€ìƒ‰ í…ŒìŠ¤íŠ¸</button>
        <div id="quick-search-result" class="console-output"></div>
    </div>

    <div class="test-section">
        <h3>5. ğŸ“Š API ìƒíƒœ í™•ì¸</h3>
        <p>ë°±ì—”ë“œ ì„œë²„ì™€ì˜ ì—°ê²° ìƒíƒœë¥¼ í™•ì¸í•©ë‹ˆë‹¤.</p>
        <button onclick="testAPIStatus()">API ìƒíƒœ í™•ì¸</button>
        <div id="api-status-result" class="console-output"></div>
    </div>

    <script>
        const API_BASE_URL = '';  // ê°™ì€ ë„ë©”ì¸ ì‚¬ìš©

        async function testGovernmentTab() {
            const resultDiv = document.getElementById('tab-test-result');
            resultDiv.textContent = 'ğŸ”„ ì •ë¶€ ë³´ë„ìë£Œ íƒ­ í…ŒìŠ¤íŠ¸ ì¤‘...\n';

            try {
                // íƒ­ ì „í™˜ ì‹œë®¬ë ˆì´ì…˜
                resultDiv.textContent += '1. íƒ­ ì „í™˜ ì‹œë„...\n';
                
                // API í˜¸ì¶œ í…ŒìŠ¤íŠ¸
                resultDiv.textContent += '2. ì •ë¶€ ë‰´ìŠ¤ API í˜¸ì¶œ í…ŒìŠ¤íŠ¸...\n';
                const response = await fetch('/api/news?agency=all&page=1&limit=6');
                const result = await response.json();
                
                resultDiv.textContent += `3. API ì‘ë‹µ: ${JSON.stringify(result, null, 2)}\n`;
                
                if (result.success) {
                    resultDiv.textContent += 'âœ… ì •ë¶€ ë³´ë„ìë£Œ íƒ­: ì‘ë™ ì¤‘\n';
                } else {
                    resultDiv.textContent += 'âŒ ì •ë¶€ ë³´ë„ìë£Œ íƒ­: API ì˜¤ë¥˜\n';
                }
                
            } catch (error) {
                resultDiv.textContent += `âŒ ì •ë¶€ ë³´ë„ìë£Œ íƒ­: ì˜¤ë¥˜ ë°œìƒ - ${error.message}\n`;
            }
        }

        async function testAgencyButtons() {
            const resultDiv = document.getElementById('agency-test-result');
            resultDiv.textContent = 'ğŸ”„ ê¸°ê´€ í•„í„° ë²„íŠ¼ í…ŒìŠ¤íŠ¸ ì¤‘...\n';

            try {
                const agencies = ['all', 'fsc', 'fss', 'ftc'];
                
                for (const agency of agencies) {
                    resultDiv.textContent += `${agency} ê¸°ê´€ API í…ŒìŠ¤íŠ¸...\n`;
                    
                    const response = await fetch(`/api/news?agency=${agency}&page=1&limit=3`);
                    const result = await response.json();
                    
                    if (result.success) {
                        resultDiv.textContent += `âœ… ${agency}: ${result.data?.length || 0}ê°œ ë°ì´í„°\n`;
                    } else {
                        resultDiv.textContent += `âŒ ${agency}: API ì˜¤ë¥˜\n`;
                    }
                }
                
            } catch (error) {
                resultDiv.textContent += `âŒ ê¸°ê´€ ë²„íŠ¼ í…ŒìŠ¤íŠ¸: ì˜¤ë¥˜ ë°œìƒ - ${error.message}\n`;
            }
        }

        async function testRefreshAPI() {
            const resultDiv = document.getElementById('refresh-test-result');
            resultDiv.textContent = 'ğŸ”„ ìƒˆë¡œê³ ì¹¨ API í…ŒìŠ¤íŠ¸ ì¤‘...\n';

            try {
                // ë¨¼ì € ì„œë²„ ìƒíƒœ í™•ì¸
                const statusResponse = await fetch('/api/status');
                const statusResult = await statusResponse.json();
                
                resultDiv.textContent += `ì„œë²„ ìƒíƒœ: ${JSON.stringify(statusResult, null, 2)}\n`;
                
                // ìŠ¤í¬ë˜í•‘ API í…ŒìŠ¤íŠ¸
                resultDiv.textContent += 'ìŠ¤í¬ë˜í•‘ API í˜¸ì¶œ ì¤‘...\n';
                const scrapeResponse = await fetch('/api/news/scrape', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });
                
                const scrapeResult = await scrapeResponse.json();
                resultDiv.textContent += `ìŠ¤í¬ë˜í•‘ ê²°ê³¼: ${JSON.stringify(scrapeResult, null, 2)}\n`;
                
                if (scrapeResult.success) {
                    resultDiv.textContent += 'âœ… ìƒˆë¡œê³ ì¹¨ API: ì •ìƒ ì‘ë™\n';
                } else {
                    resultDiv.textContent += 'âŒ ìƒˆë¡œê³ ì¹¨ API: ì˜¤ë¥˜ ë°œìƒ\n';
                }
                
            } catch (error) {
                resultDiv.textContent += `âŒ ìƒˆë¡œê³ ì¹¨ API í…ŒìŠ¤íŠ¸: ì˜¤ë¥˜ ë°œìƒ - ${error.message}\n`;
            }
        }

        async function testQuickSearch() {
            const resultDiv = document.getElementById('quick-search-result');
            resultDiv.textContent = 'ğŸ”„ ë¹ ë¥¸ ê²€ìƒ‰ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸ ì¤‘...\n';

            try {
                // ë¹ ë¥¸ ê²€ìƒ‰ ì‹œë®¬ë ˆì´ì…˜
                const testKeyword = 'AI';
                resultDiv.textContent += `í…ŒìŠ¤íŠ¸ í‚¤ì›Œë“œ: ${testKeyword}\n`;
                
                // ë„¤ì´ë²„ ë‰´ìŠ¤ ê²€ìƒ‰ URL ìƒì„± í…ŒìŠ¤íŠ¸
                const searchURL = `https://search.naver.com/search.naver?where=news&query=${encodeURIComponent(testKeyword)}&sort=1`;
                resultDiv.textContent += `ìƒì„±ëœ ê²€ìƒ‰ URL: ${searchURL}\n`;
                
                // í´ë¦­ í•¸ë“¤ëŸ¬ ì‹œë®¬ë ˆì´ì…˜
                resultDiv.textContent += 'í´ë¦­ í•¸ë“¤ëŸ¬ ì‹œë®¬ë ˆì´ì…˜...\n';
                
                // ìƒˆ ì°½ ì—´ê¸° í…ŒìŠ¤íŠ¸ (ì‹¤ì œë¡œëŠ” ì—´ì§€ ì•ŠìŒ)
                resultDiv.textContent += 'âœ… ë¹ ë¥¸ ê²€ìƒ‰ ê¸°ì‚¬ í´ë¦­: URL ìƒì„± ì •ìƒ\n';
                resultDiv.textContent += 'ğŸ“ ì‹¤ì œ í´ë¦­ ì‹œ ìƒˆ íƒ­ì—ì„œ ì—´ë¦´ ì˜ˆì •\n';
                
            } catch (error) {
                resultDiv.textContent += `âŒ ë¹ ë¥¸ ê²€ìƒ‰ í…ŒìŠ¤íŠ¸: ì˜¤ë¥˜ ë°œìƒ - ${error.message}\n`;
            }
        }

        async function testAPIStatus() {
            const resultDiv = document.getElementById('api-status-result');
            resultDiv.textContent = 'ğŸ”„ API ìƒíƒœ í™•ì¸ ì¤‘...\n';

            try {
                // ì„œë²„ ìƒíƒœ í™•ì¸
                const response = await fetch('/api/status');
                const result = await response.json();
                
                resultDiv.textContent += `API ìƒíƒœ: ${JSON.stringify(result, null, 2)}\n`;
                
                // í†µê³„ API í™•ì¸
                const statsResponse = await fetch('/api/news/stats');
                const statsResult = await statsResponse.json();
                
                resultDiv.textContent += `í†µê³„ API: ${JSON.stringify(statsResult, null, 2)}\n`;
                
                if (result.status === 'running') {
                    resultDiv.textContent += 'âœ… ë°±ì—”ë“œ ì„œë²„: ì •ìƒ ì‘ë™ ì¤‘\n';
                } else {
                    resultDiv.textContent += 'âŒ ë°±ì—”ë“œ ì„œë²„: ìƒíƒœ ë¶ˆëª…\n';
                }
                
            } catch (error) {
                resultDiv.textContent += `âŒ API ìƒíƒœ í™•ì¸: ì˜¤ë¥˜ ë°œìƒ - ${error.message}\n`;
            }
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ìë™ í…ŒìŠ¤íŠ¸
        window.addEventListener('load', () => {
            console.log('ğŸ” ë””ë²„ê·¸ í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ');
        });
    </script>
</body>
</html>