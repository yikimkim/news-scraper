<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì§ì ‘ ë””ë²„ê·¸</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .debug-panel { background: #f8f9fa; border: 1px solid #dee2e6; padding: 15px; margin: 10px 0; }
        .debug-button { padding: 10px; margin: 5px; background: #007bff; color: white; border: none; cursor: pointer; }
        .debug-result { background: #e9ecef; padding: 10px; margin: 5px 0; font-family: monospace; }
    </style>
</head>
<body>
    <h1>íƒ­ ì „í™˜ ì§ì ‘ ë””ë²„ê·¸</h1>
    
    <div class="debug-panel">
        <h3>1ë‹¨ê³„: switchTab í•¨ìˆ˜ ì§ì ‘ í˜¸ì¶œ</h3>
        <button class="debug-button" onclick="testSwitchTabDirect()">switchTab('boards') ì§ì ‘ í˜¸ì¶œ</button>
        <button class="debug-button" onclick="testSwitchTabGov()">switchTab('government') ì§ì ‘ í˜¸ì¶œ</button>
        <div class="debug-result" id="direct-result">ê²°ê³¼ ëŒ€ê¸° ì¤‘...</div>
    </div>

    <div class="debug-panel">
        <h3>2ë‹¨ê³„: DOM ìš”ì†Œ ìƒíƒœ í™•ì¸</h3>
        <button class="debug-button" onclick="checkDOMElements()">DOM ìš”ì†Œë“¤ í™•ì¸</button>
        <div class="debug-result" id="dom-result">ê²°ê³¼ ëŒ€ê¸° ì¤‘...</div>
    </div>

    <div class="debug-panel">
        <h3>3ë‹¨ê³„: ì‹¤ì œ í´ë¦­ ì´ë²¤íŠ¸ ì‹œë®¬ë ˆì´ì…˜</h3>
        <button class="debug-button" onclick="simulateTabClick('boards')">ë‚´ ê²Œì‹œíŒ íƒ­ í´ë¦­</button>
        <button class="debug-button" onclick="simulateTabClick('government')">ì •ë¶€ ë³´ë„ìë£Œ íƒ­ í´ë¦­</button>
        <div class="debug-result" id="click-result">ê²°ê³¼ ëŒ€ê¸° ì¤‘...</div>
    </div>

    <div class="debug-panel">
        <h3>ë©”ì¸ ì‚¬ì´íŠ¸ í™•ì¸</h3>
        <a href="/" target="_blank" style="display: inline-block; padding: 10px; background: #28a745; color: white; text-decoration: none;">ë©”ì¸ ì‚¬ì´íŠ¸ ìƒˆ ì°½ì—ì„œ ì—´ê¸°</a>
    </div>

    <script>
        const API_BASE_URL = window.location.origin;

        function testSwitchTabDirect() {
            const result = document.getElementById('direct-result');
            result.innerHTML = 'í…ŒìŠ¤íŠ¸ ì¤‘...';

            // ë©”ì¸ ì‚¬ì´íŠ¸ì˜ switchTab í•¨ìˆ˜ë¥¼ ì—¬ê¸°ì„œ êµ¬í˜„í•´ì„œ í…ŒìŠ¤íŠ¸
            console.log('switchTab í•¨ìˆ˜ ì§ì ‘ í…ŒìŠ¤íŠ¸ ì‹œì‘');
            
            fetch('/')
                .then(response => response.text())
                .then(html => {
                    // HTMLì—ì„œ switchTab í•¨ìˆ˜ë¥¼ ì¶”ì¶œ
                    const scriptMatch = html.match(/async function switchTab[\s\S]*?(?=\s*\/\/|function|$)/);
                    if (scriptMatch) {
                        result.innerHTML = `
                            switchTab í•¨ìˆ˜ ë°œê²¬ë¨:<br>
                            â€¢ í•¨ìˆ˜ íƒ€ì…: ${scriptMatch[0].includes('async') ? 'async' : 'sync'}<br>
                            â€¢ í•¨ìˆ˜ ê¸¸ì´: ${scriptMatch[0].length}ì<br>
                            â€¢ ìƒíƒœ: ì •ìƒì ìœ¼ë¡œ ì •ì˜ë¨
                        `;
                    } else {
                        result.innerHTML = 'âŒ switchTab í•¨ìˆ˜ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤';
                    }
                })
                .catch(error => {
                    result.innerHTML = `âŒ ì˜¤ë¥˜: ${error.message}`;
                });
        }

        function testSwitchTabGov() {
            const result = document.getElementById('direct-result');
            result.innerHTML = 'government íƒ­ í•¨ìˆ˜ í…ŒìŠ¤íŠ¸ ì¤‘...';

            // API ì—°ê²°ì„± í…ŒìŠ¤íŠ¸
            fetch(`${API_BASE_URL}/api/news?agency=all&page=1&limit=3`)
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        result.innerHTML = `
                            âœ… government íƒ­ API í…ŒìŠ¤íŠ¸ ì„±ê³µ:<br>
                            â€¢ API ì‘ë‹µ: ì •ìƒ<br>
                            â€¢ ë‰´ìŠ¤ ë°ì´í„°: ${data.data.length}ê±´<br>
                            â€¢ ìµœì‹  ë‰´ìŠ¤: "${data.data[0]?.title}"<br>
                            â†’ government íƒ­ ë°ì´í„°ëŠ” ì •ìƒ
                        `;
                    } else {
                        result.innerHTML = 'âŒ API ì‘ë‹µ ì‹¤íŒ¨';
                    }
                })
                .catch(error => {
                    result.innerHTML = `âŒ API ì˜¤ë¥˜: ${error.message}`;
                });
        }

        function checkDOMElements() {
            const result = document.getElementById('dom-result');
            result.innerHTML = 'DOM ìš”ì†Œ í™•ì¸ ì¤‘...';

            fetch('/')
                .then(response => response.text())
                .then(html => {
                    // ì£¼ìš” DOM ìš”ì†Œë“¤ í™•ì¸
                    const hasNavTabs = html.includes('class="nav-tabs"');
                    const hasBoardsTab = html.includes('onclick="switchTab(\'boards\')"');
                    const hasGovernmentTab = html.includes('onclick="switchTab(\'government\')"');
                    const hasBoardsContent = html.includes('id="boards-tab"');
                    const hasGovernmentContent = html.includes('id="government-tab"');
                    const hasSwitchTabFunction = html.includes('function switchTab');

                    result.innerHTML = `
                        DOM ìš”ì†Œ ì¡´ì¬ ì—¬ë¶€:<br>
                        â€¢ nav-tabs í´ë˜ìŠ¤: ${hasNavTabs ? 'âœ…' : 'âŒ'}<br>
                        â€¢ boards íƒ­ ë²„íŠ¼: ${hasBoardsTab ? 'âœ…' : 'âŒ'}<br>
                        â€¢ government íƒ­ ë²„íŠ¼: ${hasGovernmentTab ? 'âœ…' : 'âŒ'}<br>
                        â€¢ boards ì»¨í…ì¸ : ${hasBoardsContent ? 'âœ…' : 'âŒ'}<br>
                        â€¢ government ì»¨í…ì¸ : ${hasGovernmentContent ? 'âœ…' : 'âŒ'}<br>
                        â€¢ switchTab í•¨ìˆ˜: ${hasSwitchTabFunction ? 'âœ…' : 'âŒ'}<br>
                        
                        ${!hasBoardsTab || !hasGovernmentTab ? '<br>âŒ íƒ­ ë²„íŠ¼ onclick ì†ì„±ì— ë¬¸ì œê°€ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤!' : ''}
                        ${!hasSwitchTabFunction ? '<br>âŒ switchTab í•¨ìˆ˜ê°€ ì •ì˜ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤!' : ''}
                    `;
                })
                .catch(error => {
                    result.innerHTML = `âŒ HTML ë¶„ì„ ì˜¤ë¥˜: ${error.message}`;
                });
        }

        function simulateTabClick(tabName) {
            const result = document.getElementById('click-result');
            result.innerHTML = `${tabName} íƒ­ í´ë¦­ ì‹œë®¬ë ˆì´ì…˜ ì¤‘...`;

            // ìƒˆ ì°½ì—ì„œ ë©”ì¸ ì‚¬ì´íŠ¸ë¥¼ ì—´ê³  íƒ­ í´ë¦­ì„ ì‹œë®¬ë ˆì´ì…˜
            const newWindow = window.open('/', '_blank');
            
            if (newWindow) {
                result.innerHTML = `
                    ${tabName} íƒ­ í…ŒìŠ¤íŠ¸:<br>
                    â€¢ ìƒˆ ì°½ì—ì„œ ë©”ì¸ ì‚¬ì´íŠ¸ê°€ ì—´ë ¸ìŠµë‹ˆë‹¤<br>
                    â€¢ ìˆ˜ë™ìœ¼ë¡œ "${tabName === 'boards' ? 'ğŸ“‚ ë‚´ ê²Œì‹œíŒ' : 'ğŸ›ï¸ ì •ë¶€ ë³´ë„ìë£Œ'}" íƒ­ì„ í´ë¦­í•´ë³´ì„¸ìš”<br>
                    â€¢ íƒ­ ì „í™˜ì´ ë˜ëŠ”ì§€ ì§ì ‘ í™•ì¸í•˜ì„¸ìš”<br>
                    <br>
                    ë§Œì•½ íƒ­ ì „í™˜ì´ ë˜ì§€ ì•ŠëŠ”ë‹¤ë©´:<br>
                    1. F12ë¥¼ ëˆŒëŸ¬ ê°œë°œì ë„êµ¬ë¥¼ ì—´ê³ <br>
                    2. Console íƒ­ì—ì„œ ì˜¤ë¥˜ ë©”ì‹œì§€ë¥¼ í™•ì¸í•˜ì„¸ìš”<br>
                    3. 'switchTab is not defined' ê°™ì€ ì˜¤ë¥˜ê°€ ìˆëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”
                `;
            } else {
                result.innerHTML = 'âŒ íŒì—…ì´ ì°¨ë‹¨ë˜ì—ˆìŠµë‹ˆë‹¤. ë¸Œë¼ìš°ì € íŒì—… ì°¨ë‹¨ì„ í•´ì œí•´ì£¼ì„¸ìš”.';
            }
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ìë™ DOM í™•ì¸
        window.addEventListener('load', () => {
            setTimeout(checkDOMElements, 1000);
        });
    </script>
</body>
</html>